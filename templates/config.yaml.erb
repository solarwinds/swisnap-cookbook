---
log_level: <%= node['swisnap']['swisnap_log_level'] %>
log_path: <%= node['swisnap']['swisnap_log_path'] %>
<%- if defined?(node['swisnap']['swisnap_log_format']) && ! node['swisnap']['swisnap_log_format'].empty? -%>
log_format: <%= node['swisnap']['swisnap_log_format'] %>
<%- end -%>

control:
  auto_discover_path: <%= node['swisnap']['swisnap_auto_discover_path'] %>
  tasks_autoload_path: <%= node['swisnap']['swisnap_tasks_autoload_path'] %>
  plugin_path: <%= node['swisnap']['swisnap_plugin_path'] %>
  task_path: <%= node['swisnap']['swisnap_task_path'] %>

  <%- if defined?(node['swisnap']['swisnap_plugin_trust_level']) && ! node['swisnap']['swisnap_plugin_trust_level'].empty? -%>
  plugin_trust_level: <%= node['swisnap']['swisnap_plugin_trust_level'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_keyring_paths']) && ! node['swisnap']['swisnap_keyring_paths'].empty? -%>
  keyring_paths: <%= node['swisnap']['swisnap_keyring_paths'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_tls_cert_path']) && ! node['swisnap']['swisnap_tls_cert_path'].empty? && defined?(node['swisnap']['swisnap_tls_key_path']) && ! node['swisnap']['swisnap_tls_key_path'].empty? -%>
  tls_cert_path: <%= node['swisnap']['swisnap_tls_cert_path'] %>
  tls_key_path: <%= node['swisnap']['swisnap_tls_key_path'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_plugin_tls_cert_path']) && ! node['swisnap']['swisnap_plugin_tls_cert_path'].empty? && defined?(node['swisnap']['swisnap_plugin_tls_key_path']) && ! node['swisnap']['swisnap_plugin_tls_key_path'].empty? -%>
  plugin_tls_cert_path: <%= node['swisnap']['swisnap_plugin_tls_cert_path'] %> 
  plugin_tls_key_path: <%= node['swisnap']['swisnap_plugin_tls_key_path'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_ca_cert_paths']) && ! node['swisnap']['swisnap_ca_cert_paths'].empty? -%>
  ca_cert_paths: <%= node['swisnap']['swisnap_ca_cert_paths'] %> 
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_plugin_load_timeout']) && ! node['swisnap']['swisnap_plugin_load_timeout'].empty? -%>
  plugin_load_timeout: <%= node['swisnap']['swisnap_plugin_load_timeout'] %>
  <%- end -%>
  plugins:
    include: <%= node['swisnap']['swisnap_plugin_config_dir'] %>
  <%- if defined?(node['swisnap']['swisnap_global_tags']) && ! node['swisnap']['swisnap_global_tags'].empty? -%>
  tags:
    /:
  <%- for tag_key, tag_value in node['swisnap']['swisnap_global_tags'] do -%>
      <%= tag_key %>: <%= tag_value %>
  <%- end -%>
  <%- end -%>

restapi:
  enable: <%= node['swisnap']['swisnap_restapi_enable'] %>
  <%- if defined?(node['swisnap']['swisnap_restapi_addr']) && ! node['swisnap']['swisnap_restapi_addr'].empty? -%>
  addr: <%= node['swisnap']['swisnap_restapi_addr'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_restapi_rest_auth']) && ! node['swisnap']['swisnap_restapi_rest_auth'].empty? -%>
  rest_auth: <%= node['swisnap']['swisnap_restapi_rest_auth'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_restapi_rest_auth_password']) && ! node['swisnap']['swisnap_restapi_rest_auth_password'].empty? -%>
  rest_auth_password: <%= node['swisnap']['swisnap_restapi_rest_auth_password'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_restapi_rest_certificate']) && ! node['swisnap']['swisnap_restapi_rest_certificate'].empty? -%>
  rest_certificate: <%= node['swisnap']['swisnap_restapi_rest_certificate'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_restapi_rest_key']) && ! node['swisnap']['swisnap_restapi_rest_key'].empty? -%>
  rest_key: <%= node['swisnap']['swisnap_restapi_rest_key'] %>
  <%- end -%>
  <%- if defined?(node['swisnap']['swisnap_restapi_plugin_load_timeout']) && ! node['swisnap']['swisnap_restapi_plugin_load_timeout'].empty? -%>
  plugin_load_timeout: <%= node['swisnap']['swisnap_restapi_plugin_load_timeout'] %>
  <%- end -%>
